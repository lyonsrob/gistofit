<!DOCTYPE html>
<html>
<head>
  <meta charset="utf8">
  <title>Steroids App</title>

  <link rel="stylesheet" href="/vendor/ionic/css/ionic.css" />
  <link rel="stylesheet" href="/custom.css" />
  <link rel="stylesheet" href="/stylesheets/application.css" />
  <link rel="stylesheet" href="/components/angular-pull-to-refresh/dist/angular-pull-to-refresh.min.css">

  <script src="/cordova.js"></script>
  <script src="/components/steroids-js/steroids.js"></script>
  <script src="/components/steroids-data/dist/steroids.data.js"></script>

  <script src="/components/angular/angular.js"></script>
  <script src="/components/ngAnimate/js/angular-animate.min.js"></script>
  <script src="/components/angular-sanitize/angular-sanitize.min.js"></script>
  <script src="/components/angular-pull-to-refresh/dist/angular-pull-to-refresh.min.js"></script>
  <script src="/components/lodash/dist/lodash.js"></script>
  <!-- script src="/components/jquery/jquery.js"></script -->

  <script src="/controllers/application.js"></script>
  
  <script src="/models/models.js"></script>
  <!-- script src="/models/angular-embedly.js"></script>
  <script src="/models/gistofit.js"></script -->
 
  <script src="/controllers/Comments.js"></script>
</head>
<body ng-app="gistOfItApp" class="content">

<div id="global-spinner-div">
  <div class="global-blackout"></div>
  <div class="global-modal-container">
    <div class="global-spinner-container">
      <i class="icon ion-ios7-reloading"></i>
    </div>
  </div>
</div>

  <style>
  .comment_component .user_name small {
    color: #999999;
    font-size: 14px;
  }
  .comment_component .item p {
    white-space: normal;
  }
  .comment_component .item p.message {
    color: #333333;
  }
  .comment_component .item-input-inset {
    padding-left: 70px;
    min-height: 70px;
  }
  .comment_component .item-input-inset img:first-child {
    position: absolute;
    top: 14px;
    left: 15px;
    max-width: 40px;
    max-height: 40px;
    width: 100%;
    border-radius: 4px;
  }
  .comment_component .item-input-wrapper {
    padding: 6px;
  }

  .comment_component .gray, .comment_component .gray * {
    color: #999 !important;
  }
  .comment_component .gray img {
    opacity: 0.5;
  }
  .comment_component .message.error {
    color: red !important;
  }
  .comment_component .hide {
    display: none;
  }
</style>
<script src="/components/moment/moment.js"></script>
<div ng-controller="CommentsCtrl" class="padding comment_component">

    <form ng-submit="add()">
      <div class="item item-input-inset">
        <img ng-src="{{currentUser.user_image_url}}">
        <label class="item-input-wrapper">
          <input type="text" placeholder="Add Comment" ng-model="message">
        </label>
        <button class="button button-clear">
          Send
        </button>
      </div>
    </form>

    <div
      class="item item-avatar item-icon-right"
      ng-class="{hide: comment.removed == true, gray: comment.notYetSaved == true}"
      ng-repeat="comment in comments | orderBy:'-created_at'">
      <img ng-src="{{comment.user_image_url}}">
      <h2 class="user_name">
        <strong>{{comment.user}}</strong><br />
        <small>{{comment.created}}</small>
      </h2>

      <p class="message error" ng-if="comment.error">
        {{comment.error}}
      </p>

      <p class="message">
        {{comment.content}}
      </p>

      <i class="icon ion-ios7-close-empty" ng-if="!comment.failed && comment.user_id == currentUser.user_id" ng-click="remove(comment)"></i>

      <i class="icon ion-ios7-refresh-empty" ng-if="comment.failed && comment.user_id == currentUser.user_id" ng-click="retrySave(comment)"></i>


    </div>

</div>


<script>
  window.globalSpinner = {
    show: function() {
      document.ontouchmove = function(e){ 
        e.preventDefault(); 
      }
      document.getElementById("global-spinner-div").style.display = 'block';
    },
    hide: function() {
      document.getElementById("global-spinner-div").style.display = 'none';
      document.ontouchmove = function(e){ return true; }
    }
  };
</script>

</body>
</html>
